
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- saved from url=(0014)about:internet -->

<html xmlns="http://www.w3.org/1999/xhtml">

<head>
<meta content="zh-cn" http-equiv="Content-Language" />
<meta content="text/html; charset=utf-8" http-equiv="Content-Type" />
<title>腹部脂肪VAT计算</title>

<script src="jquery-1.12.4.min.js"></script>
<link rel="stylesheet" href="css.css" media="all">
<style type="text/css">
.basic-grey {
	width:580px;
	float:left;
	margin:2%;
}

.basic-grey-right {
	width:580px;
	float:right;
	margin:2%;
}
.basic-grey label,.basic-grey-right label {
	display:block;
	margin:0px;
}


</style>
</head>

<body>


<form action="" id="man_form" name="man_form" method="post" class="basic-grey">
	<h1>
		
        男性腹部脂肪VAT计算
		<span style="color:red">
			Age,height,weight为必选项，其他数据填写越详细结果越精准.
		</span>
	</h1>
	<label>
		<span style="coler:red">
			Age:<br/>(0~120)
		</span>
		<input id="man_age" type="number" name="man_age" placeholder="Age(0~120)" min="0" max="120"/>
	</label>
	<label>
		<span>
			Height:<br/>(50~250cm)
		</span>
		<input id="man_height" type="number" name="man_height" placeholder="Height(50~250cm)" min="50" max="250"
		/>
	</label>
	<label>
		<span>
			Weight:<br/>(20~250kg)
		</span>
		<input id="man_weight" type="number" name="man_weight" placeholder="Weight(20~250kg)" min="20" max="250"
		/>
	</label>
	<label>
		<span>
			WC:<br/>(15~250cm)
		</span>
		<input id="man_wc" type="number" name="man_wc" placeholder="WC(15~250cm)" min="15" max="250"
		/>
	</label>
	<label>
		<span>
			HC:<br/>(15~250cm)
		</span>
		<input id="man_hc" type="number" name="man_hc" placeholder="HC(15~250cm)" min="15" max="250"
		/>
	</label>
	<label>
		<span>
			Whole body fat mass:<br/>(0~150kg)
		</span>
		<input id="man_Whole_body_fat_mass" type="number" name="man_Whole_body_fat_mass" placeholder="Whole body fat mass(0~150kg)" min="0" max="150"
		/>
	</label>
	<label>
		<span>
			Whole body fat free mass:<br/>(0~150kg)
		</span>
		<input id="man_Whole_body_fat_free_mass" type="number" name="man_Whole_body_fat_free_mass" placeholder="Whole body fat free mass(0~150kg)" min="0" max="150"
		/>
	</label>
	<label>
		<span>
			Trunk fat mass:<br/>(0~80kg)
		</span>
		<input id="man_Trunk_fat_mass" type="number" name="man_Trunk_fat_mass" placeholder="Trunk fat mass(0~80kg)" min="0" max="80"
		/>
	</label>
	
	<label>
		<span>
			Trunk fat free mass:<br/>(0~80kg)
		</span>
		<input id="man_Trunk_fat_free_mass" type="number" name="man_Trunk_fat_free_mass" placeholder="Trunk fat free mass(0~80kg)" min="0" max="40"
		/>
	</label>
	<label>
		<span>
			Leg fatfree mass:<br/>(0~40kg)
		</span>
		<input id="man_Leg_fatfree_mass" type="number" name="man_Leg_fatfree_mass" placeholder="Leg fatfree mass(0~40kg)" min="0" max="40"
		/>
	</label>
	<label>
		<span>
			Basal metabolic rate:<br/>(500~30000kJ)
		</span>
		<input id="man_Basal_metabolic_rate" type="number" name="man_Basal_metabolic_rate" placeholder="Basal metabolic rate(500~30000kJ)" min="500" max="30000"
		/>
	</label>
	<label>
		<input type="button" class="button" id="man_button" name="man_button" value="Calculate (please click)" onclick="getRisk('man')"/>
	</label>
	
	<label style="display:none;margin-top: 20px" class="explain" id="man_result_span">
		<span>
			result:
		</span>
		<div id="man_result_info"></div>
	</label>
	<!--
	<label>
		<span>
			upload cvs:
		</span>
		<input id="man_file" type="file" name="man_file"/><input type="button" class="button" id="man_file_button" name="man_file_button" value="batch" />
		<a>download csv modle</a>
	</label>
	-->
</form>


<form action="" id="man_form" name="man_form" method="post" class="basic-grey-right">
	<h1>		
		女性腹部脂肪VAT计算
		<span style="color:red">
			Age,height,weight为必选项，其他数据填写越详细结果越精准.
		</span>
	</h1>
	<label>
		<span style="coler:red">
			Age:<br/>(0~120)
		</span>
		<input id="woman_age" type="number" name="woman_age" placeholder="Age(0~120)" min="0" max="120"/>
	</label>
	<label>
		<span>
			Height:<br/>(50~250cm)
		</span>
		<input id="woman_height" type="number" name="woman_height" placeholder="Height(50~250cm)" min="50" max="250"
		/>
	</label>
	<label>
		<span>
			Weight:<br/>(20~250kg)
		</span>
		<input id="woman_weight" type="number" name="woman_weight" placeholder="Weight(20~250kg)" min="20" max="250"
		/>
	</label>
	<label>
		<span>
			WC:<br/>(15~250cm)
		</span>
		<input id="woman_wc" type="number" name="woman_wc" placeholder="WC(15~250cm)" min="15" max="250"
		/>
	</label>
	<label>
		<span>
			HC:<br/>(15~250cm)
		</span>
		<input id="woman_hc" type="number" name="woman_hc" placeholder="HC(15~250cm)" min="15" max="250"
		/>
	</label>
	<label>
		<span>
			Whole body fat mass:<br/>(0~150kg)
		</span>
		<input id="woman_Whole_body_fat_mass" type="number" name="woman_Whole_body_fat_mass" placeholder="Whole body fat mass(0~150kg)" min="0" max="150"
		/>
	</label>
	<label>
		<span>
			Whole body fat free mass:<br/>(0~150kg)
		</span>
		<input id="woman_Whole_body_fat_free_mass" type="number" name="woman_Whole_body_fat_free_mass" placeholder="Whole body fat free mass(0~150kg)" min="0" max="150"
		/>
	</label>
	<label>
		<span>
			Trunk fat mass:<br/>(0~80kg)
		</span>
		<input id="woman_Trunk_fat_mass" type="number" name="woman_Trunk_fat_mass" placeholder="Trunk fat mass(0~80kg)" min="0" max="80"
		/>
	</label>
	
	<label>
		<span>
			Trunk fat free mass:<br/>(0~80kg)
		</span>
		<input id="woman_Trunk_fat_free_mass" type="number" name="woman_Trunk_fat_free_mass" placeholder="Trunk fat free mass(0~80kg)" min="0" max="40"
		/>
	</label>
	<label>
		<span>
			Leg fatfree mass:<br/>(0~40kg)
		</span>
		<input id="woman_Leg_fatfree_mass" type="number" name="woman_Leg_fatfree_mass" placeholder="Leg fatfree mass(0~40kg)" min="0" max="40"
		/>
	</label>
	<label>
		<span>
			Basal metabolic rate:<br/>(500~30000kJ)
		</span>
		<input id="woman_Basal_metabolic_rate" type="number" name="woman_Basal_metabolic_rate" placeholder="Basal metabolic rate(500~30000kJ)" min="500" max="30000"
		/>
	</label>
	<label>
		<input type="button" class="button" id="wowoman_button" name="woman_button" value="Calculate (please click)" onclick="getRisk('woman')"/>
	</label>
	
	<label style="display:none;margin-top: 20px" class="explain" id="woman_result_span">
		<span>
			result:
		</span>
		<div id="woman_result_info"></div>
	</label>
</form>

<script type="text/javascript">

	//get parameters from form
	var Age;	
	var Height;
	var Weight;
	var wc;
	var hc;
	var Whole_body_fat_mass;
	var Whole_body_fat_free_mass;
	var Trunk_fat_mass;
	var Trunk_fat_free_mass;
	var Leg_fatfree_mass;
	var Basal_metabolic_rate;
	var Objgender;
	var sex = 1;//0是女性，1是男性
	var result_info;
	var result_span;
	
	function getRisk(gender){
		Objgender = gender;
		if(gender == "woman"){
			sex = 0;
		}
		Age = $("#" + gender + "_age");	
		Height = $("#" + gender + "_height");
		Weight = $("#" + gender + "_weight");
		wc = $("#" + gender + "_wc");
		hc = $("#" + gender + "_hc");
		Whole_body_fat_mass = $("#" + gender + "_Whole_body_fat_mass");
		Whole_body_fat_free_mass = $("#" + gender + "_Whole_body_fat_free_mass");
		Trunk_fat_mass = $("#" + gender + "_Trunk_fat_mass");
		Trunk_fat_free_mass = $("#" + gender + "_Trunk_fat_free_mass");
		Leg_fatfree_mass = $("#" + gender + "_Leg_fatfree_mass");
		Basal_metabolic_rate = $("#" + gender + "_Basal_metabolic_rate");
		result_info = $("#" + gender + "_result_info");
		result_span = $("#" + gender + "_result_span");
		//必填验证
		if(!checkForm1()){
			return false;
		}
		//全部不为空时按公式3计算
		if(!checkForm2_isnull() && !checkForm3_isnull()){
			if(checkForm2_scope() && checkForm3_scope()){
				//公式3
				$(result_info).html("公式3");
				$(result_span).fadeIn("slow");			
			}
			
		}else if(!checkForm2_isnull()){
			if(checkForm2_scope()){
				//公式2
				$(result_info).html("公式2");
				$(result_span).fadeIn("slow");
			}
		//公式1
		}else {		
			// 男
			if(sex==1){
				/** 原公式
			   VAT = [3.643001 
						+ (-0.01225432)*Height + (0.85249813)*ln(Weight) 
						+ (31834.57241168)*Height^(-2) + (-92.20461434)*ln(Weight)^(-2) 
						+ (0.00218163)*Age*ln(Weight)]^2 **/
				var VAT = Math.pow(3.643001 + (-0.01225432)*$(Height).val() + (0.85249813)*Math.log($(Weight).val()) + (31834.57241168)* Math.pow($(Height).val(),-2) + (-92.20461434)* Math.pow(Math.log($(Weight).val()),-2) + (0.00218163)*$(Age).val()*Math.log($(Weight).val()),2);
				
				$(result_info).html("公式1记算:" + VAT.toFixed(3));
				$(result_span).fadeIn("slow");
			}
			// 女
			if(sex==0){
				/** 原公式
			   VAT = [-2.538071 
						+ (-0.00618113)*Height + (1.48219618)*ln(Weight) 
						+ (-1155.36103141)*Age^(-2) + (7513.36791386)*Height^(-2) 
						+ (55.13712057)*Height^(-1) + (3.89774410)*Height^(-0.5) 
						+ (0.00000000)*Height^0.5 + (-0.00001134)*Height^2 
						+ (-26.10013911)*ln(Weight)^(-2)]^2 **/
				var VAT = Math.pow(-2.538071+ (-0.00618113)*$(Height).val() + (1.48219618)*Math.log($(Weight).val())+ (-1155.36103141)*Math.pow($(Age).val(),-2) + (7513.36791386)*Math.pow($(Height).val(),-2)+ (55.13712057)*Math.pow($(Height).val(),-1) + (3.89774410)* Math.pow($(Height).val(),-0.5)+ (0.00000000)*Math.pow($(Height).val(),0.5) + (-0.00001134)*Math.pow($(Height).val(),2)+ (-26.10013911)*Math.pow(Math.log($(Weight).val()),-2),2);
				
				$(result_info).html("公式1记算:" + VAT.toFixed(3));
				$(result_span).fadeIn("slow");
			}
		}
		
	
	
	//calculate for b
	//var b = 0.329 * iptAge + 0.415 * iptSmoking - 0.871 * Math.log(iptTbi ) + 0.099 * iptSbp -0.0017 * iptAge * iptSbp -3.097 * iptAbi
	//var c = 1- Math.pow(0.975,Math.exp(-12.598+b))
	//returnRisk = c
	//document.getElementById("riskValue").innerHTML=Number(returnRisk *100).toFixed(2)+"%"
	//if (returnRisk <= 0.0314 )
	//{document.getElementById("riskCate").innerHTML="Low Risk"
//}
	//else if (returnRisk > 0.0314)
	//{document.getElementById("riskCate").innerHTML="High Risk"
//}
	//alert(returnRisk)//结果弹窗显示
	}
	
	
	function checkForm1() {	
        /**    if ($(Age).val()!=null && $(Age).val()!="" && $(Age).val()>=0 && $(Age).val()<=120 ) {
                $(Age).css("border", "");
            } else {
                $(Age).css("border", "1px solid red");
				$(Age).focus();
				return false;
            }
            
            if ($(Height).val()!=null && $(Height).val()!="" && $(Height).val()>=50 && $(Height).val()<=250 ) {
                $(Height).css("border", "");
            } else {
                $(Height).css("border", "1px solid red");
				$(Height).focus();
				return false;
            }
			
            if ($(Weight).val()!=null && $(Weight).val()!="" && $(Weight).val()>=20 && $(Weight).val()<=250 ) {
                $(Weight).css("border", "");
            } else {
                $(Weight).css("border", "1px solid red");
				$(Weight).focus();
				return false;
            }**/
			return true;
	}
	function checkForm2_isnull() {	
            if (($(wc).val()==null || $(wc).val()=="") || ($(hc).val()==null || $(hc).val()=="")) {
				return true;
            }
			return false;
	}
	
	function checkForm2_scope() {	
			if($(wc).val()!=null && $(wc).val()!=""){
				if ($(wc).val()>=15 && $(wc).val()<=250 ) {
					$(wc).css("border", "");
				} else {
					$(wc).css("border", "1px solid red");
					$(wc).focus();
					return false;
				}
			}
			if($(hc).val()!=null && $(hc).val()!=""){
				if($(hc).val()>=15 && $(hc).val()<=250 ) {
					$(hc).css("border", "");
				} else {
					$(hc).css("border", "1px solid red");
					$(hc).focus();
					return false;
				}	
			}
			return true;
	}
	
	function checkForm3_isnull() {	
			if ($(Whole_body_fat_mass).val()==null || $(Whole_body_fat_mass).val()=="" ||
			$(Whole_body_fat_free_mass).val()==null || $(Whole_body_fat_free_mass).val()=="" ||
			$(Trunk_fat_mass).val()==null || $(Trunk_fat_mass).val()=="" || 
			$(Trunk_fat_free_mass).val()==null || $(Trunk_fat_free_mass).val()=="" || 
			$(Leg_fatfree_mass).val()==null || $(Leg_fatfree_mass).val()=="" || 
			$(Basal_metabolic_rate).val()==null || $(Basal_metabolic_rate).val()==""){
				return true;
			}           
			return false;
	}
	
	function checkForm3_scope() {	
			if($(Whole_body_fat_mass).val()!=null && $(Whole_body_fat_mass).val()!=""){
				if($(Whole_body_fat_mass).val()>=0 && $(Whole_body_fat_mass).val()<=150 ) {
					$(Whole_body_fat_mass).css("border", "");
				} else {
					$(Whole_body_fat_mass).css("border", "1px solid red");
					$(Whole_body_fat_mass).focus();
					return false;
				}
			}
			if($(Whole_body_fat_free_mass).val()!=null && $(Whole_body_fat_free_mass).val()!=""){
				if($(Whole_body_fat_free_mass).val()>=0 && $(Whole_body_fat_free_mass).val()<=150 ) {
					$(Whole_body_fat_free_mass).css("border", "");
				} else {
					$(Whole_body_fat_free_mass).css("border", "1px solid red");
					$(Whole_body_fat_free_mass).focus();
					return false;
				}
			}
			if($(Trunk_fat_mass).val()!=null && $(Trunk_fat_mass).val()!=""){
				if($(Trunk_fat_mass).val()>=0 && $(Trunk_fat_mass).val()<=80 ) {
					$(Trunk_fat_mass).css("border", "");
				} else {
					$(Trunk_fat_mass).css("border", "1px solid red");
					$(Trunk_fat_mass).focus();
					return false;
				}
			}
			if($(Trunk_fat_free_mass).val()!=null && $(Trunk_fat_free_mass).val()!=""){
				if($(Trunk_fat_free_mass).val()>=0 && $(Trunk_fat_free_mass).val()<=80 ) {
					$(Trunk_fat_free_mass).css("border", "");
				} else {
					$(Trunk_fat_free_mass).css("border", "1px solid red");
					$(Trunk_fat_free_mass).focus();
					return false;
				}
			}
			if($(Leg_fatfree_mass).val()!=null && $(Leg_fatfree_mass).val()!=""){
				if($(Leg_fatfree_mass).val()>=0 && $(Leg_fatfree_mass).val()<=40 ) {
					$(Leg_fatfree_mass).css("border", "");
				} else {
					$(Leg_fatfree_mass).css("border", "1px solid red");
					$(Leg_fatfree_mass).focus();
					return false;
				}
			}
			if($(Basal_metabolic_rate).val()!=null && $(Basal_metabolic_rate).val()!=""){
				if($(Basal_metabolic_rate).val()>=500 && $(Basal_metabolic_rate).val()<=30000 ) {
					$(Basal_metabolic_rate).css("border", "");
				} else {
					$(Basal_metabolic_rate).css("border", "1px solid red");
					$(Basal_metabolic_rate).focus();
					return false;
				}
			}
			return true;
	}
</script>

</body>

</html>
